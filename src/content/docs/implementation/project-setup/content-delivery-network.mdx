---
title: CDN setup
description: Configure a CDN for your Adobe Commerce project.
---

## CDN setup

* Decide early which CDN to use. A popular option is Fastly, which is included with the Adobe Commerce license.

* Guidance on Fastly CDN configuration can be requested from the Adobe team via Slack. 

* Configure a subdomain for development (e.g. [aem.customer.com](http://aem.customer.com/)).
  * **Please ensure that this site is not crawl-able by search engines (e.g. via robots.txt).**

* Setup Edge Delivery CDN configuration according to documentation.
  * For cache invalidation, a Fastly API key is required. This key can be requested from Adobe Commerce support team.
  * Ensure compression (e.g. gzip) is correctly working.

* Proxy certain paths back to Adobe Commerce. This is specific to the project, but generally you should at least proxy the following paths:
  * Core GraphQL (e.g. https://customer-commerce/graphql → /graphql)
    * Ensure proper CORS headers are sent, so the endpoint can be accessed from hlx.page, hlx.live and localhost:3000 hosts.
  * Catalog Service / LiveSearch endpoints
    * Production: https://catalog-service.adobe.io/graphql → /cs-graphql
    * Sandbox: https://catalog-service-sandbox.adobe.io/graphql → /cs-graphql-sandbox
    * Please ensure to remove all cookies from requests as Catalog Service has a relatively small HTTP header limit
  * Product images coming from Adobe Commerce (e.g. /catalog/product/resized/200x200/3/_/3_1_1_12_2.jpeg)
  * Additional paths required for Luma Bridge.

* Cache Validation
  
  * It is fundamental that you validate that caching is working correctly. This should include requests with cookie headers and query parameters. 

   ```bash
   curl -sI -H 'Fastly-Debug: 1' https://www.bulk.com/uk/ | grep x-cache
 
   x-cache: MISS, HIT, HIT, HIT
   x-cache-hits: 0, 16, 102, 1
   ```
   * x-cache values are read right to left, where the rightmost value represents the customer CDN (Commerce Fastly). This value should indicate a cache HIT.

* Surrogate Key Validation
  * The default Adobe Commerce Fastly configuration overwrites surrogate keys set by Edge Delivery.

    ```bash
    curl -sI -H 'Fastly-Debug: 1' https://www.bulk.com/uk/ | grep surrogate-key
 
    surrogate-key: main--bul-eds--thepixel 401e079ea9d66cbdc48fc9bcd3a958206ef36cd2affcd6b672178e7628f RKvjyvNRGjNtCHP3 401e079ea9d66cbdc48fc9bcd3a958206ef36cd2affcd6b672178e7628f_metadata main--bul-eds--thepixel_head
    ```

    * When correctly set, the surrogate keys should include at least two ref-repo-org references as indicated in the example above.